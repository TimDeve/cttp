(deftype HttpStatus
  Ok
  NotFound)

(defmodule Res
  (sig send (Fn [HttpStatus String String] Response))
  (defn send [status content-type body]
   (Response.init
     (match status
      HttpStatus.Ok 200
      HttpStatus.NotFound 404)
     (match status
      HttpStatus.Ok @"OK"
      HttpStatus.NotFound @"Not Found")
     @"HTTP/1.1"
     []
     {@"Server" [@"Carp"]
      @"Content-Type" [content-type]
      @"Content-Length" [(str (length &body))]}
     body)))
